# JARVIS Multi-Agent System

![JARVIS](images.jpeg)

Мультиагентная система для выполнения Python кода и CLI команд. Для получения ключей для теста написать @owacota

## Что было сделано

### Исходная точка
Jupyter notebook с простым циклом обработки запросов, использующим Mistral API напрямую, локальные эмбеддинги через sentence-transformers и RAG по захардкоженным документам.

### Основные улучшения

**Архитектура**
- Переписали монолитный notebook в модульную структуру с разделением на агентов, инструменты, память и конфигурацию
- Внедрили LangGraph для управления состоянием и маршрутизации между агентами вместо простого while-цикла
- Разделили логику на 4 специализированных агента: Orchestrator, Analyst, Command Agent и CLI Agent

**Интеграции**
- Заменили Mistral API на OpenAI-compatible интерфейс, что позволяет использовать любого провайдера (OpenRouter, Together AI, локальные модели)
- Перешли с локальных эмбеддингов на API-эмбеддинги, что решило проблему timeout при загрузке моделей
- Заменили RAG по документам на Tavily для реального веб-поиска актуальной информации

**Инструменты**
- Реализовали tool use через LangChain вместо ручного парсинга JSON из ответов модели
- Добавили инструменты для выполнения Python кода, CLI команд, веб-поиска и работы с памятью
- Исправили executor чтобы возвращал только вывод print(), а не весь namespace переменных

**Пользовательский опыт**
- Добавили потоковый вывод через Rich для отображения прогресса в реальном времени
- Сделали подробное логирование каждого шага: какой агент работает, какие инструменты вызываются, какие результаты получены
- Вынесли промпты в отдельные YAML файлы для удобного редактирования

**Память**
- Сохранили векторную память на FAISS, но перевели эмбеддинги на API
- Добавили метаданные к записям в памяти (агент, тип действия, временная метка)
- Разделили инструменты памяти: добавление доступно только Orchestrator, поиск — всем агентам

**Автодебаг**
- При ошибке выполнения кода агент автоматически анализирует ошибку и пытается исправить код
- До 3 попыток исправления перед выдачей финального результата

## Выполнение кода

Код выполняется в том же Python процессе через `exec()`. Все пакеты из venv доступны (sklearn, pandas, numpy и т.д.). Каждый вызов имеет изолированный namespace — переменные между вызовами не сохраняются.

## Структура

Проект разбит на модули: агенты в отдельных папках со своими графами и состояниями, инструменты как LangChain tools, промпты в YAML, конфигурация через переменные окружения.

## Запуск

Установить зависимости, заполнить .env файл с API ключами, запустить примеры из папки examples.
